var R=Object.defineProperty;var V=(t,e,i)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var u=(t,e,i)=>V(t,typeof e!="symbol"?e+"":e,i);const v={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return t==0?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return t==1?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return t==0?0:t==1?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var a=1.70158,e=0,i=1;if(t==0)return 0;if((t/=1)==1)return 1;if(e||(e=.3),i<Math.abs(1)){i=1;var a=e/4}else var a=e/(2*Math.PI)*Math.asin(1/i);return-(i*Math.pow(2,10*(t-=1))*Math.sin((t*1-a)*(2*Math.PI)/e))},easeOutElastic:function(t){var a=1.70158,e=0,i=1;if(t==0)return 0;if((t/=1)==1)return 1;if(e||(e=.3),i<Math.abs(1)){i=1;var a=e/4}else var a=e/(2*Math.PI)*Math.asin(1/i);return i*Math.pow(2,-10*t)*Math.sin((t*1-a)*(2*Math.PI)/e)+1},easeInOutElastic:function(t){var a=1.70158,e=0,i=1;if(t==0)return 0;if((t/=.5)==2)return 1;if(e||(e=.44999999999999996),i<Math.abs(1)){i=1;var a=e/4}else var a=e/(2*Math.PI)*Math.asin(1/i);return t<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*1-a)*(2*Math.PI)/e)):i*Math.pow(2,-10*(t-=1))*Math.sin((t*1-a)*(2*Math.PI)/e)*.5+1},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-v.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<.36363636363636365?1*(7.5625*t*t):t<.7272727272727273?1*(7.5625*(t-=.5454545454545454)*t+.75):t<.9090909090909091?1*(7.5625*(t-=.8181818181818182)*t+.9375):1*(7.5625*(t-=.9545454545454546)*t+.984375)},easeInOutBounce:function(t){return t<.5?v.easeInBounce(t*2)*.5:v.easeOutBounce(t*2-1)*.5+.5}},k=function(t){return!isNaN(parseFloat(t))&&isFinite(t)};function K(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function O(t,e,i){return k(e)&&t>e?e:k(i)&&t<i?i:t}class A{constructor(e,i){u(this,"animFrameAmount");u(this,"easingFunction");u(this,"percentAnimComplete",0);u(this,"_chart");u(this,"opts");const{config:a}=i;this.opts=i,this._chart=e,this.animFrameAmount=a.animation?1/this.CapValue(a.animationSteps,Number.MAX_VALUE,1):1,this.easingFunction=v[a.animationEasing],this.percentAnimComplete=a.animation?0:1,console.log(a),requestAnimationFrame(()=>{this.animLoop()})}animLoop(){this.percentAnimComplete+=this.animFrameAmount,this.animateFrame();const{config:e}=this.opts;this.percentAnimComplete<=1?requestAnimationFrame(()=>{this.animLoop()}):typeof this.opts.config.onAnimationComplete=="function"&&e.onAnimationComplete()}animateFrame(){const{config:e,drawData:i}=this.opts,a=e.animation?this.CapValue(this.easingFunction(this.percentAnimComplete),null,0):1;this._chart.clear(),i(a),this.opts.drawScale()}CapValue(e,i,a){return O(e,i,a)}}function F(t,e,i){const{height:a,width:s,ctx:r}=e;let l=a;r.font=i.scaleFontStyle+" "+i.scaleFontSize+"px "+i.scaleFontFamily;let o=1,n=0;for(let d=0;d<t.labels.length;d++){let h=r.measureText(t.labels[d]).width;o=h>o?h:o}return s/t.labels.length<o?(n=45,s/t.labels.length<Math.cos(n)*o?(n=90,l-=o):l-=Math.sin(n)*o):l-=i.scaleFontSize*2,l-=5,{labelHeight:i.scaleFontSize,widestXLabel:o,rotateLabels:n,scaleHeight:l}}function T(t,e,i){let a=Number.MIN_VALUE,s=Number.MAX_VALUE;for(let o=0;o<t.datasets.length;o++)for(let n=0;n<t.datasets[o].data.length;n++)t.datasets[o].data[n]>a&&(a=t.datasets[o].data[n]),t.datasets[o].data[n]<s&&(s=t.datasets[o].data[n]);let r=Math.floor(e/(i*.66)),l=Math.floor(e/i*.5);return{maxValue:a,minValue:s,maxSteps:r,minSteps:l}}function X(t){return Math.floor(Math.log(t)/Math.LN10)}function W(t,e,i,a,s){const r=i-a,l=X(r),o=Math.floor(a/(1*Math.pow(10,l)))*Math.pow(10,l),n=Math.ceil(i/(1*Math.pow(10,l)))*Math.pow(10,l),f=n-o;let c=Math.pow(10,l),d=Math.round(f/c);for(;d<e||d>t;)d<e?(c/=2,d=Math.round(f/c)):(c*=2,d=Math.round(f/c));const h=[];return E(s,h,d,o,c),{steps:d,stepValue:c,graphMin:o,graphMax:n,labels:h}}function E(t,e,i,a,s){if(t)for(let r=1;r<i+1;r++)e.push(I(t,{value:Math.floor(Number((a+s*r).toFixed(z(s))))}))}function z(t){return t%1!=0?t.toString().split(".")[1].length:0}function I(t,e,i={}){let a=/\W/.test(t)?new Function("obj","let p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[t]=i[t]||I(document.getElementById(t).innerHTML,i);return e?a(e):a}function b(t,e,i){const a=e.steps*e.stepValue,s=t-e.graphMin,r=O(s/a,1,0);return i*e.steps*r}const H=(t,{widestXLabel:e,data:i,scaleHeight:a},s,r)=>{const{ctx:l,width:o}=r,n=s;let f=1;if(s.scaleShowLabels){l.font=n.scaleFontStyle+" "+n.scaleFontSize+"px "+n.scaleFontFamily;for(var c=0;c<t.length;c++){const m=l.measureText(t[c]).width;f=m>f?m:f}f+=10}const d=o-f-e,h=Math.floor(d/i.labels.length),p=(h-n.scaleGridLineWidth*2-n.barValueSpacing*2-(n.barDatasetSpacing*i.datasets.length-1)-(n.barStrokeWidth/2*i.datasets.length-1))/i.datasets.length,g=o-e/2-d,w=a+n.scaleFontSize/2;return{valueHop:h,yAxisPosX:g,xAxisPosY:w,barWidth:p,widestXLabel:e,xAxisLength:d}};let Y=0;const G=()=>"g-charts"+Y++,N=t=>{const e=t.canvas.width,i=t.canvas.height;window.devicePixelRatio&&(t.canvas.style.width=e+"px",t.canvas.style.height=i+"px",t.canvas.height=i*window.devicePixelRatio,t.canvas.width=e*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio))},Q=t=>{let e=t.parentNode;return e==null?void 0:e.clientWidth},D=function(t){return t.parentNode.clientHeight};class _{constructor(e){u(this,"_chart");u(this,"options");u(this,"context");u(this,"id");u(this,"private_attr",{drawPointer:!1});this._chart=e,this.id=G()}injectContext(e){this.context=e,this.options=e._options,this.axisPointer()}axisPointer(){var e,i;(i=(e=this.options)==null?void 0:e.axisPointer)!=null&&i.show&&(this.private_attr.drawPointer=!1,this._chart.canvas.addEventListener("mousemove",a=>{this._handlePointer(a)}),this._chart.canvas.addEventListener("mouseout",()=>{this._mouseOutPointer()}))}_mouseOutPointer(){this.private_attr.drawPointer&&(this._drawPointer([[0,0],[0,0]],!1),this.private_attr.drawPointer=!1)}_handlePointer(e){const i=this._chart,{offsetX:a,offsetY:s}=e,{width:r}=i,{barAttr:l}=this.context,{widestXLabel:o,xAxisLength:n,xAxisPosY:f}=l,c=r-o/2-n,d=r-o/2+5,h=f+3,p=14,g=[[c,s],[d,s]];a>=c&&a<=d&&s>=p&&s<=h?(this._drawPointer(g),this.private_attr.drawPointer=!0):this.private_attr.drawPointer&&(this._drawPointer(g,!1),this.private_attr.drawPointer=!1)}_drawPointer(e,i=!0){if(this._chart.clear(),this.context.render(),i){const{ctx:a}=this._chart,{_options:s}=this.context;a.save(),a.beginPath(),a.strokeStyle=s.axisPointer.lineStyle,a.moveTo(...e[0]),a.lineTo(...e[1]),a.closePath(),a.stroke();const{scaleHop:r,calculatedScale:l,yAxisPosX:o}=this.context.barAttr,{axisPointer:n}=this.context.options,[f,c]=e[0],d=l.graphMax-Math.floor((c-13)/r*l.stepValue),h=o-5,p=c,g=a.measureText(d+"").width;a.save(),a.fillStyle=n.background,a.fillRect(h-g-5,p-n.fontSize+5,g+10,14),a.fillStyle=n.color,a.fillText(d+"",h,p)}}}class B{constructor(e,i){u(this,"chart");u(this,"context");u(this,"drawScale",()=>{const{ctx:e,width:i}=this.chart,a=this.context._options,s=this.context.datasets,{widestXLabel:r,xAxisPosY:l,yAxisPosX:o,xAxisLength:n,rotateLabels:f,valueHop:c,calculatedScale:d,scaleHop:h}=this.context.barAttr;e.lineWidth=a.scaleLineWidth,e.strokeStyle=a.scaleLineColor,e.beginPath(),e.moveTo(i-r/2+5,l),e.lineTo(i-r/2-n-5,l),e.stroke(),f>0?(e.save(),e.textAlign="right"):e.textAlign="center",e.fillStyle=a.scaleFontColor;for(var p=0;p<s.labels.length;p++)e.save(),f>0?(e.translate(o+p*c,l+a.scaleFontSize),e.rotate(-(f*(Math.PI/180))),e.fillText(s.labels[p],0,0),e.restore()):e.fillText(s.labels[p],o+p*c+c/2,l+a.scaleFontSize+3),e.beginPath(),e.moveTo(o+(p+1)*c,l+3),e.lineWidth=a.scaleGridLineWidth,e.strokeStyle=a.scaleGridLineColor,e.lineTo(o+(p+1)*c,5),e.stroke();e.lineWidth=a.scaleLineWidth,e.strokeStyle=a.scaleLineColor,e.beginPath(),e.moveTo(o,l),e.lineTo(o,14),e.stroke(),e.textAlign="right",e.textBaseline="middle";for(var g=0;g<d.steps;g++)e.beginPath(),e.moveTo(o-3,l-(g+1)*h),a.scaleShowGridLines?(e.lineWidth=a.scaleGridLineWidth,e.strokeStyle=a.scaleGridLineColor,e.lineTo(o+n+5,l-(g+1)*h)):e.lineTo(o-.5,l-(g+1)*h),e.stroke(),a.scaleShowLabels&&e.fillText(d.labels[g],o-8,l-(g+1)*h)});this.chart=e,this.context=i}}class j extends _{constructor(i,a,s){super(s);u(this,"defaultConfig",{scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:!1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!1,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:2,animation:!0,animationSteps:60,animationEasing:"easeOutQuart",axisPointer:{show:!0,fontSize:14,lineStyle:"#999",color:"#fff",background:"#B4B4B4"}});u(this,"_options");u(this,"chart");u(this,"datasets");u(this,"barAttr",{valueHop:0,yAxisPosX:0,xAxisPosY:0,barWidth:0,scaleHop:0,widestXLabel:1,xAxisLength:0,rotateLabels:0,scaleHeight:0,calculatedScale:{steps:0,stepValue:0,graphMin:0,labels:[]}});u(this,"animation",null);u(this,"scale");u(this,"drawBars",i=>{const{ctx:a}=this.chart,s=this._options,r=this.datasets,{valueHop:l,yAxisPosX:o,xAxisPosY:n,barWidth:f,calculatedScale:c,scaleHop:d}=this.barAttr;a.lineWidth=s.barStrokeWidth;for(let h=0;h<r.datasets.length;h++){a.fillStyle=r.datasets[h].fillColor,a.strokeStyle=r.datasets[h].strokeColor;for(let p=0;p<r.datasets[h].data.length;p++){let g=o+s.barValueSpacing+l*p+f*h+s.barDatasetSpacing*h+s.barStrokeWidth*h;a.beginPath(),a.moveTo(g,n),a.lineTo(g,n-i*b(r.datasets[h].data[p],c,d)+s.barStrokeWidth/2),a.lineTo(g+f,n-i*b(r.datasets[h].data[p],c,d)+s.barStrokeWidth/2),a.lineTo(g+f,n),s.barShowStroke&&a.stroke(),a.closePath(),a.fill()}}});this.datasets=i,this._options={...s.default.global,...this.defaultConfig,...a},this.chart=s,this.scale=new B(this.chart,this),this.calcBar(i,this._options),this.injectContext(this)}setOption(i,a){this.datasets=i,this._options={...this.chart.default.global,...this.defaultConfig,...a},this.calcBar(i,this._options)}calcBar(i,a){const{labelHeight:s,widestXLabel:r,scaleHeight:l,rotateLabels:o}=F(i,this.chart,this._options),n=T(i,l,s),f=a.scaleShowLabels?a.scaleLabel:"",c=W(n.maxSteps,n.minSteps,n.maxValue,n.minValue,f),d=Math.floor(l/c.steps),{valueHop:h,yAxisPosX:p,xAxisPosY:g,barWidth:w,xAxisLength:m}=H(c.labels,{widestXLabel:r,data:i,scaleHeight:l},this._options,this.chart);this.barAttr={valueHop:h,yAxisPosX:p,xAxisPosY:g,barWidth:w,calculatedScale:c,scaleHop:d,widestXLabel:r,xAxisLength:m,rotateLabels:o,scaleHeight:l},this.animation=new A(this.chart,{config:this._options,drawData:this.drawBars,drawScale:this.scale.drawScale})}render(){this.scale.drawScale(),this.drawBars(1)}}class q extends _{constructor(i,a){super(a);u(this,"defaultConfig",{data:[],labels:[],riseColor:"#d60a22",depreciateColor:"#037b66",axisPointer:{show:!0,fontSize:14,lineStyle:"#999",color:"#fff",background:"#B4B4B4"}});u(this,"chart");u(this,"scale");u(this,"_options");u(this,"barAttr",{valueHop:0,yAxisPosX:0,xAxisPosY:0,barWidth:0,scaleHop:0,widestXLabel:1,xAxisLength:0,rotateLabels:0,scaleHeight:0,calculatedScale:{steps:0,stepValue:0,graphMin:0,labels:[]}});u(this,"datasets");u(this,"animation",null);u(this,"drawkLine",i=>{const{ctx:a}=this.chart,{yAxisPosX:s,xAxisPosY:r,valueHop:l,calculatedScale:o,scaleHop:n}=this.barAttr,{riseColor:f,depreciateColor:c}=this._options,d=this._options;for(const h in d.data){const p=Number(h),g=d.data[p],[w,m,M,P]=g,L=m>w;a.beginPath(),a.fillStyle=L?f:c,a.strokeStyle=L?f:c;const x=s+p*l+l/2,S=r-i*b(Math.max(w,m),o,n),C=r-i*b(Math.min(w,m),o,n),y=Math.max(S,C)-Math.min(S,C);a.fillRect(x-5,S,10,y),a.moveTo(x,r-i*b(M,o,n)),a.lineTo(x,r-i*b(Math.max(w,m),o,n)),a.moveTo(x,r-i*b(P,o,n)),a.lineTo(x,S+y),a.stroke()}});this._options={...this.defaultConfig,...this._chart.default.global,...i},this.datasets={labels:i.labels,datasets:[{data:i.data.flat(),fillColor:"#f5804d"}]},this.chart=a,this.scale=new B(this.chart,this),this.injectContext(this),this.calcCandlestick()}setOption(i){this._options={...this.defaultConfig,...this._chart.default.global,...i},this.datasets={labels:i.labels,datasets:[{data:i.data.flat(),fillColor:"#f5804d"}]},this.calcCandlestick()}calcCandlestick(){const{labelHeight:i,widestXLabel:a,scaleHeight:s,rotateLabels:r}=F(this.defaultConfig,this.chart,this._chart.default.global),{labels:l,barValueSpacing:o}=this._options,{scaleShowLabels:n,scaleLabel:f}=this._chart.default.global,c=T({labels:l,datasets:this.datasets.datasets},s,i),d=n?f:"",h=W(c.maxSteps,c.minSteps,c.maxValue,c.minValue,d),p=Math.floor(s/h.steps),{valueHop:g,yAxisPosX:w,xAxisPosY:m,barWidth:M,xAxisLength:P}=H(h.labels,{widestXLabel:a,data:this.datasets,scaleHeight:s},{...this._options,barValueSpacing:o||0,scaleGridLineWidth:0,barDatasetSpacing:0,barStrokeWidth:0},this.chart);this.barAttr={valueHop:g,yAxisPosX:w,xAxisPosY:m,barWidth:M,calculatedScale:h,scaleHop:p,widestXLabel:a,xAxisLength:P,rotateLabels:r,scaleHeight:s},this.animation=new A(this.chart,{config:this._options,drawData:this.drawkLine,drawScale:this.scale.drawScale})}render(){this.scale.drawScale(),this.drawkLine(1)}}class U extends _{constructor(i,a,s){super(s);u(this,"_options",{segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1});u(this,"pieAttr",{radius:0,segmentTotal:0,data:[]});u(this,"animation");u(this,"drawPie",i=>{const{_options:a,pieAttr:s}=this,{ctx:r,width:l,height:o}=this._chart;let n=0,f=1,c=1;a.animation&&(a.animateScale&&(f=i),a.animateRotate&&(c=i));for(var d=0;d<s.data.length;d++){const p=s.data[d];var h=c*(p.value/s.segmentTotal*(Math.PI*2));r.beginPath(),r.arc(l/2,o/2,f*s.radius,n,n+h),r.lineTo(l/2,o/2),r.fillStyle=p.color,r.fill(),r.closePath(),a.segmentShowStroke&&(r.lineWidth=a.segmentStrokeWidth,r.strokeStyle=a.segmentStrokeColor,r.stroke()),n+=h}});this._options={...this._options,...a},this.injectContext(this),this.calcPie(i)}setOption(i,a){this._options={...this._options,...a},this.calcPie(i)}calcPie(i){const{width:a,height:s}=this._chart,r=Math.min(a/2,s/2)-5,l=i.reduce((o,n)=>o+n.value,0);this.pieAttr={radius:r,segmentTotal:l,data:i},this.animation=new A(this._chart,{config:this._options,drawData:this.drawPie,drawScale:()=>{}})}}class J{constructor(e,i){u(this,"canvas");u(this,"ctx");u(this,"width");u(this,"height");u(this,"aspectRatio");u(this,"default",{global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}});this.canvas=e.canvas,this.default.global={...this.default.global,...i},this.ctx=e,console.log(e),this.width=e.canvas.width,this.height=e.canvas.height,this.aspectRatio=this.width/this.height,window.devicePixelRatio&&(e.canvas.style.width=this.width+"px",e.canvas.style.height=this.height+"px",e.canvas.height=this.height*window.devicePixelRatio,e.canvas.width=this.width*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}resize(e){const i=this.canvas,a=Q(this.canvas),s=this.default.global.maintainAspectRatio?a/this.aspectRatio:D(this.canvas);return i.width=this.width=a,i.height=this.height=s,N(this.ctx),typeof e=="function"&&(e==null||e(this)),this}clear(){this.ctx.clearRect(0,0,this.width,this.height)}bar(e){return new j(e,this.default.global,this)}kLine(e){return new q(e,this)}pie(e,i){return new U(e,i,this)}}export{J as G,K as g};
